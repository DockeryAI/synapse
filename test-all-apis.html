<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Synapse - All 17 Data Sources Test</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      overflow: hidden;
    }

    header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }

    header h1 {
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 10px;
    }

    header p {
      font-size: 16px;
      opacity: 0.9;
    }

    .content {
      padding: 30px;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      border-radius: 8px;
      text-align: center;
    }

    .stat-card .number {
      font-size: 36px;
      font-weight: 700;
      margin-bottom: 5px;
    }

    .stat-card .label {
      font-size: 14px;
      opacity: 0.9;
    }

    .controls {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }

    button {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 14px;
      font-weight: 600;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s;
    }

    button:hover {
      background: #5568d3;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    button:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    button.secondary {
      background: #48bb78;
    }

    button.secondary:hover {
      background: #38a169;
    }

    .api-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }

    .api-card {
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      padding: 20px;
      transition: all 0.3s;
    }

    .api-card:hover {
      border-color: #667eea;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
    }

    .api-card.testing {
      border-color: #f6ad55;
      background: #fffaf0;
    }

    .api-card.success {
      border-color: #48bb78;
      background: #f0fff4;
    }

    .api-card.error {
      border-color: #f56565;
      background: #fff5f5;
    }

    .api-header {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
    }

    .api-icon {
      font-size: 24px;
      margin-right: 10px;
    }

    .api-name {
      font-size: 18px;
      font-weight: 600;
      color: #2d3748;
    }

    .api-status {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .api-status.pending {
      background: #e2e8f0;
      color: #4a5568;
    }

    .api-status.testing {
      background: #fed7d7;
      color: #c53030;
    }

    .api-status.success {
      background: #c6f6d5;
      color: #22543d;
    }

    .api-status.error {
      background: #fed7d7;
      color: #c53030;
    }

    .api-message {
      font-size: 14px;
      color: #4a5568;
      line-height: 1.6;
    }

    .api-details {
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid #e2e8f0;
      font-size: 12px;
      color: #718096;
    }

    .progress-bar {
      height: 8px;
      background: #e2e8f0;
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 20px;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      width: 0%;
      transition: width 0.3s;
    }

    .error-details {
      margin-top: 8px;
      padding: 8px;
      background: #fff;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-size: 11px;
      color: #c53030;
      max-height: 100px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üöÄ Synapse Intelligence Platform</h1>
      <p>Testing All 17 Data Sources</p>
    </header>

    <div class="content">
      <div class="stats">
        <div class="stat-card">
          <div class="number" id="totalSources">17</div>
          <div class="label">Total Sources</div>
        </div>
        <div class="stat-card">
          <div class="number" id="passedCount">0</div>
          <div class="label">Passed</div>
        </div>
        <div class="stat-card">
          <div class="number" id="failedCount">0</div>
          <div class="label">Failed</div>
        </div>
        <div class="stat-card">
          <div class="number" id="pendingCount">17</div>
          <div class="label">Pending</div>
        </div>
      </div>

      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>

      <div class="controls">
        <button id="testAllBtn" onclick="testAll()">üß™ Test All Sources</button>
        <button class="secondary" onclick="copyResults()">üìã Copy Results</button>
        <button class="secondary" onclick="exportJson()">üíæ Export JSON</button>
      </div>

      <div class="api-grid" id="apiGrid"></div>
    </div>
  </div>

  <script type="module">
    // API test definitions
    const apiTests = [
      {
        id: 'openrouter',
        name: 'OpenRouter/Claude',
        icon: 'ü§ñ',
        category: 'AI',
        test: async () => {
          const key = import.meta.env.VITE_OPENROUTER_API_KEY;
          if (!key) throw new Error('API key not set');

          const response = await fetch('https://openrouter.ai/api/v1/models', {
            headers: { 'Authorization': `Bearer ${key}` }
          });

          if (!response.ok) throw new Error(`HTTP ${response.status}`);
          const data = await response.json();
          return `‚úÖ Connected (${data.data?.length || 0} models available)`;
        }
      },
      {
        id: 'youtube',
        name: 'YouTube Data API',
        icon: 'üì∫',
        category: 'Content',
        test: async () => {
          const key = import.meta.env.VITE_YOUTUBE_API_KEY;
          if (!key) throw new Error('API key not set');

          const response = await fetch(
            `https://www.googleapis.com/youtube/v3/search?part=snippet&q=marketing&maxResults=1&key=${key}`
          );

          if (!response.ok) throw new Error(`HTTP ${response.status}`);
          const data = await response.json();
          return `‚úÖ Connected (${data.pageInfo?.totalResults || 0} results available)`;
        }
      },
      {
        id: 'outscraper',
        name: 'OutScraper (Google Maps)',
        icon: 'üó∫Ô∏è',
        category: 'Local',
        test: async () => {
          const { OutScraperAPI } = await import('./src/services/intelligence/outscraper-api.ts');
          const results = await OutScraperAPI.getBusinessListings({
            query: 'cafe',
            location: 'San Francisco',
            limit: 1
          });
          return `‚úÖ Connected (found ${results.length} businesses)`;
        }
      },
      {
        id: 'news',
        name: 'News API (newsapi.ai)',
        icon: 'üì∞',
        category: 'Content',
        test: async () => {
          const { NewsAPI } = await import('./src/services/intelligence/news-api.ts');
          const articles = await NewsAPI.getIndustryNews('technology', ['AI', 'software']);
          return `‚úÖ Connected (${articles.length} articles)`;
        }
      },
      {
        id: 'weather',
        name: 'Weather API',
        icon: 'üå§Ô∏è',
        category: 'Context',
        test: async () => {
          const { WeatherAPI } = await import('./src/services/intelligence/weather-api.ts');
          const weather = await WeatherAPI.getCurrentWeather('San Francisco');
          return `‚úÖ Connected (${weather.location}, ${Math.round(weather.temperature)}¬∞F)`;
        }
      },
      {
        id: 'serper-news',
        name: 'Serper - News',
        icon: 'üì°',
        category: 'Search',
        test: async () => {
          const { SerperAPI } = await import('./src/services/intelligence/serper-api.ts');
          const news = await SerperAPI.getNews('technology');
          return `‚úÖ Connected (${news.length} articles)`;
        }
      },
      {
        id: 'serper-trends',
        name: 'Serper - Trends',
        icon: 'üìà',
        category: 'Search',
        test: async () => {
          const { SerperAPI } = await import('./src/services/intelligence/serper-api.ts');
          const trends = await SerperAPI.getTrends('AI');
          return `‚úÖ Connected (${trends.length} trends)`;
        }
      },
      {
        id: 'serper-autocomplete',
        name: 'Serper - Autocomplete',
        icon: 'üîç',
        category: 'Search',
        test: async () => {
          const { SerperAPI } = await import('./src/services/intelligence/serper-api.ts');
          const suggestions = await SerperAPI.getAutocomplete('marketing');
          return `‚úÖ Connected (${suggestions.length} suggestions)`;
        }
      },
      {
        id: 'serper-places',
        name: 'Serper - Places',
        icon: 'üìç',
        category: 'Search',
        test: async () => {
          const { SerperAPI } = await import('./src/services/intelligence/serper-api.ts');
          const places = await SerperAPI.getPlaces('coffee shop', 'San Francisco');
          return `‚úÖ Connected (${places.length} places)`;
        }
      },
      {
        id: 'serper-images',
        name: 'Serper - Images',
        icon: 'üñºÔ∏è',
        category: 'Search',
        test: async () => {
          const { SerperAPI } = await import('./src/services/intelligence/serper-api.ts');
          const images = await SerperAPI.getImages('logo design');
          return `‚úÖ Connected (${images.length} images)`;
        }
      },
      {
        id: 'serper-videos',
        name: 'Serper - Videos',
        icon: 'üé•',
        category: 'Search',
        test: async () => {
          const { SerperAPI } = await import('./src/services/intelligence/serper-api.ts');
          const videos = await SerperAPI.getVideos('marketing tips');
          return `‚úÖ Connected (${videos.length} videos)`;
        }
      },
      {
        id: 'serper-shopping',
        name: 'Serper - Shopping',
        icon: 'üõí',
        category: 'Search',
        test: async () => {
          const { SerperAPI } = await import('./src/services/intelligence/serper-api.ts');
          const products = await SerperAPI.getShopping('laptop');
          return `‚úÖ Connected (${products.length} products)`;
        }
      },
      {
        id: 'serper-general',
        name: 'Serper - General Search',
        icon: 'üîé',
        category: 'Search',
        test: async () => {
          const { SerperAPI } = await import('./src/services/intelligence/serper-api.ts');
          const results = await SerperAPI.searchGoogle('AI marketing trends');
          return `‚úÖ Connected (${results.length} results)`;
        }
      },
      {
        id: 'semrush',
        name: 'SEMrush (via Edge Function)',
        icon: 'üìä',
        category: 'SEO',
        test: async () => {
          const { SemrushAPI } = await import('./src/services/intelligence/semrush-api.ts');
          const overview = await SemrushAPI.getDomainOverview('example.com');
          return `‚úÖ Connected (domain data retrieved)`;
        }
      },
      {
        id: 'reddit',
        name: 'Reddit (via Edge Function)',
        icon: 'üî¥',
        category: 'Social',
        test: async () => {
          const { redditAPI } = await import('./src/services/intelligence/reddit-api.ts');
          const subreddits = await redditAPI.findRelevantSubreddits('marketing');
          return `‚úÖ Connected (${subreddits.length} subreddits found)`;
        }
      },
      {
        id: 'website-analyzer',
        name: 'Website Analyzer (Claude)',
        icon: 'üåê',
        category: 'Analysis',
        test: async () => {
          const { websiteAnalyzer } = await import('./src/services/intelligence/website-analyzer.service.ts');
          // Test with a simple URL
          const analysis = await websiteAnalyzer.analyzeWebsite('https://example.com');
          return `‚úÖ Connected (analysis complete)`;
        }
      },
      {
        id: 'apify',
        name: 'Apify (Web Scraping)',
        icon: 'üï∑Ô∏è',
        category: 'Scraping',
        test: async () => {
          const key = import.meta.env.VITE_APIFY_API_KEY;
          if (!key) throw new Error('API key not set');

          const response = await fetch(`https://api.apify.com/v2/key-value-stores?token=${key}&limit=1`);

          if (!response.ok) throw new Error(`HTTP ${response.status}`);
          return `‚úÖ Connected (API key valid)`;
        }
      }
    ];

    // State
    let results = {};
    let passedCount = 0;
    let failedCount = 0;

    // Initialize UI
    function initUI() {
      const grid = document.getElementById('apiGrid');
      grid.innerHTML = apiTests.map(api => `
        <div class="api-card" id="card-${api.id}">
          <div class="api-header">
            <div class="api-icon">${api.icon}</div>
            <div class="api-name">${api.name}</div>
          </div>
          <div class="api-status pending" id="status-${api.id}">Pending</div>
          <div class="api-message" id="message-${api.id}">Not tested yet</div>
          <div class="api-details">${api.category}</div>
        </div>
      `).join('');
    }

    // Update stats
    function updateStats() {
      document.getElementById('passedCount').textContent = passedCount;
      document.getElementById('failedCount').textContent = failedCount;
      document.getElementById('pendingCount').textContent = apiTests.length - passedCount - failedCount;

      const progress = ((passedCount + failedCount) / apiTests.length) * 100;
      document.getElementById('progressFill').style.width = progress + '%';
    }

    // Test single API
    async function testAPI(api) {
      const card = document.getElementById(`card-${api.id}`);
      const status = document.getElementById(`status-${api.id}`);
      const message = document.getElementById(`message-${api.id}`);

      card.className = 'api-card testing';
      status.className = 'api-status testing';
      status.textContent = 'Testing...';
      message.textContent = 'Running test...';

      try {
        const result = await api.test();

        card.className = 'api-card success';
        status.className = 'api-status success';
        status.textContent = 'Success';
        message.textContent = result;

        results[api.id] = { status: 'success', message: result };
        passedCount++;
      } catch (error) {
        card.className = 'api-card error';
        status.className = 'api-status error';
        status.textContent = 'Failed';
        message.innerHTML = `‚ùå ${error.message}<div class="error-details">${error.stack || error.toString()}</div>`;

        results[api.id] = { status: 'error', message: error.message, stack: error.stack };
        failedCount++;
      }

      updateStats();
    }

    // Test all APIs
    window.testAll = async function() {
      const btn = document.getElementById('testAllBtn');
      btn.disabled = true;
      btn.textContent = '‚è≥ Testing...';

      passedCount = 0;
      failedCount = 0;
      results = {};
      updateStats();

      for (const api of apiTests) {
        await testAPI(api);
        await new Promise(resolve => setTimeout(resolve, 100)); // Small delay between tests
      }

      btn.disabled = false;
      btn.textContent = '‚úÖ Test Complete!';

      setTimeout(() => {
        btn.textContent = 'üß™ Test All Sources';
      }, 3000);
    };

    // Copy results
    window.copyResults = function() {
      const text = Object.entries(results).map(([id, result]) => {
        const api = apiTests.find(a => a.id === id);
        return `${api.name}: ${result.status === 'success' ? '‚úÖ' : '‚ùå'} ${result.message}`;
      }).join('\n');

      navigator.clipboard.writeText(text);
      alert('Results copied to clipboard!');
    };

    // Export JSON
    window.exportJson = function() {
      const json = JSON.stringify({ results, passedCount, failedCount, totalTests: apiTests.length }, null, 2);
      const blob = new Blob([json], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'synapse-api-test-results.json';
      a.click();
    };

    initUI();
  </script>
</body>
</html>
